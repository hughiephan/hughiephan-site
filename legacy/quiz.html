<link rel="stylesheet" href="quiz.css">
<link rel="stylesheet" href="index.css">
<link href="https://fonts.googleapis.com/css?family=DM+Sans:400,500,700&display=swap" rel="stylesheet">
<div class="app-container">
    <div class="left-area">
        <button class="btn-close-left">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="feather feather-x-circle" viewBox="0 0 24 24">
                <defs />
                <circle cx="12" cy="12" r="10" />
                <path d="M15 9l-6 6M9 9l6 6" />
            </svg>
        </button>
        <div class="app-name"></div>
        <a href="index.html" class="item-link active" id="pageLink">
            <p>Main</p>
        </a>
        <a href="course.html" class="item-link" id="pageLink">
            <p>Course</p>
        </a>
        <a href="tutorial.html" class="item-link" id="pageLink">
            <p>Tutorial</p>
        </a>
        <a href="research.html" class="item-link" id="pageLink">
            <p>Research</p>
        </a>
        <a href="quiz.html" class="item-link" id="pageLink">
            <p>Quiz</p>
        </a>
    </div>
    <div class="main-area">
        <button class="btn-show-right-area">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-left">
                <polyline points="15 18 9 12 15 6" />
            </svg>
        </button>
        <button class="btn-show-left-area">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="12" x2="21" y2="12" />
                <line x1="3" y1="6" x2="21" y2="6" />
                <line x1="3" y1="18" x2="21" y2="18" />
            </svg>
        </button>
        <section class="quiz-container">
            <div id='quiz'></div> 
        </section>
    </div>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-analytics.js";

const firebaseConfig = {
    apiKey: "AIzaSyC3wEhSRAdPHaBbqve2YUTsW7zys63Dy6E",
    authDomain: "quizfan-c8a21.firebaseapp.com",
    databaseURL: "https://quizfan-c8a21-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "quizfan-c8a21",
    storageBucket: "quizfan-c8a21.appspot.com",
    messagingSenderId: "53254171522",
    appId: "1:53254171522:web:3ebbf0062b66605e07bd9b",
    measurementId: "G-NFZ9MW8MR0"
};

const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const db = getDatabase();

function loadQuizData() {
    const quizRef = ref(db, "quiz1");
    get(quizRef).then(function(snapshot) {
        if (snapshot.exists()) {
            const quizData = snapshot.val();
            buildQuiz(quizData);
        } else {
            console.log("No quiz data found");
        }
    }).catch(function(error) {
        console.error("Error loading quiz data: ", error);
    });
}

function buildQuiz(quizData) {
    const quizContainer = document.getElementById("quiz");
    const output = [];
    for (const questionId in quizData) {
        const question = quizData[questionId].question;
        const options = quizData[questionId].options;
        const feedbackText = quizData[questionId].feedback;
        const questionHTML = '<div class="question">' + question + '</div>';
        let optionsHTML = '';
        for (let i = 0; i < options.length; i++) {
            optionsHTML += '<label><input type="radio" name="question' + questionId + '" value="' + i + '">' + options[i] + '</label><br>';
        }
        output.push('<div class="question-container">' + questionHTML + optionsHTML + '<div class="feedback"> </div></div> <br>');
    }
    quizContainer.innerHTML = output.join('');
    const radioButtons = quizContainer.querySelectorAll("input[type='radio']");
    radioButtons.forEach(function(radio) {
        radio.addEventListener("change", function() {
            const selectedOption = this.value;
            const questionContainer = this.closest(".question-container");
            const feedback = questionContainer.querySelector(".feedback");
            feedback.classList.add("feedback");

            const questionId = this.name.replace("question", "");
            const answer = quizData[questionId].answer;
            const feedbackText = quizData[questionId].feedback;

            if (selectedOption == answer) {
                feedback.innerText = "Correct! ";
                feedback.classList.add("correct-answer");
            } else {
                feedback.innerText = "Incorrect ! \n The correct answer is: " + quizData[questionId].options[answer];
                feedback.classList.add("wrong-answer");
            }
        });
    })
}

loadQuizData()
</script>

